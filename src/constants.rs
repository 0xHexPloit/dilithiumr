use crate::algebra::poly::Polynomial;
use crate::algebra::vec::PolyVec;

pub const Q: u32 = 8380417; // 2**23 - 2**13 + 1;
pub const Q_INVERSE: i32 = 58728449; // Q^(-1) mod 2**32 <- T
pub const D: u8 = 13; // Dropped bits from t

pub const ZETA_BYTES: usize = 32;

pub const SEED_BYTES: usize = 128;
pub const RHO_BYTES: usize = 32;

pub const RHO_PRIME_BYTES: usize = 64;

pub const TR_BYTES: usize = 32;

pub const BIG_K_BYTES: usize = 32;

pub const MU_BYTES: usize = 64;

pub const C_TILDE_BYTES: usize = 32;

pub const N: usize = 256; // Ring degree

pub const POLY_T0_PACKED_BYTES: usize = 416;
pub const POLY_T1_PACKED_BYTES: usize = 320;

const SHAKE128_RATE: usize = 168;
pub const STREAM128_BLOCKBYTES: usize = SHAKE128_RATE;

pub const SHAKE256_RATE: usize = 132;
pub const STREAM256_BLOCKBYTES: usize = SHAKE256_RATE;

const REJ_UNIFORM_NBLOCKS: usize = (768 + STREAM128_BLOCKBYTES - 1) / STREAM128_BLOCKBYTES;
pub const REJ_UNIFORM_BUFLEN: usize = REJ_UNIFORM_NBLOCKS * STREAM128_BLOCKBYTES;

const POLY_UNIFORM_ETA_2_NB_BLOCKS: usize = (136 + STREAM128_BLOCKBYTES - 1) / STREAM128_BLOCKBYTES;
const POLY_UNIFORM_ETA_4_NB_BLOCKS: usize = (227 + STREAM128_BLOCKBYTES - 1) / STREAM128_BLOCKBYTES;

pub const POLY_UNIFORM_ETA_2_BUFLEN: usize = POLY_UNIFORM_ETA_2_NB_BLOCKS * STREAM256_BLOCKBYTES;
pub const POLY_UNIFORM_ETA_4_BUFLEN: usize = POLY_UNIFORM_ETA_4_NB_BLOCKS * STREAM256_BLOCKBYTES;

pub const ZETAS: [i32; 256] = [
    0, 25847, -2608894, -518909, 237124, -777960, -876248, 466468, 1826347, 2353451, -359251,
    -2091905, 3119733, -2884855, 3111497, 2680103, 2725464, 1024112, -1079900, 3585928, -549488,
    -1119584, 2619752, -2108549, -2118186, -3859737, -1399561, -3277672, 1757237, -19422, 4010497,
    280005, 2706023, 95776, 3077325, 3530437, -1661693, -3592148, -2537516, 3915439, -3861115,
    -3043716, 3574422, -2867647, 3539968, -300467, 2348700, -539299, -1699267, -1643818, 3505694,
    -3821735, 3507263, -2140649, -1600420, 3699596, 811944, 531354, 954230, 3881043, 3900724,
    -2556880, 2071892, -2797779, -3930395, -1528703, -3677745, -3041255, -1452451, 3475950,
    2176455, -1585221, -1257611, 1939314, -4083598, -1000202, -3190144, -3157330, -3632928, 126922,
    3412210, -983419, 2147896, 2715295, -2967645, -3693493, -411027, -2477047, -671102, -1228525,
    -22981, -1308169, -381987, 1349076, 1852771, -1430430, -3343383, 264944, 508951, 3097992,
    44288, -1100098, 904516, 3958618, -3724342, -8578, 1653064, -3249728, 2389356, -210977, 759969,
    -1316856, 189548, -3553272, 3159746, -1851402, -2409325, -177440, 1315589, 1341330, 1285669,
    -1584928, -812732, -1439742, -3019102, -3881060, -3628969, 3839961, 2091667, 3407706, 2316500,
    3817976, -3342478, 2244091, -2446433, -3562462, 266997, 2434439, -1235728, 3513181, -3520352,
    -3759364, -1197226, -3193378, 900702, 1859098, 909542, 819034, 495491, -1613174, -43260,
    -522500, -655327, -3122442, 2031748, 3207046, -3556995, -525098, -768622, -3595838, 342297,
    286988, -2437823, 4108315, 3437287, -3342277, 1735879, 203044, 2842341, 2691481, -2590150,
    1265009, 4055324, 1247620, 2486353, 1595974, -3767016, 1250494, 2635921, -3548272, -2994039,
    1869119, 1903435, -1050970, -1333058, 1237275, -3318210, -1430225, -451100, 1312455, 3306115,
    -1962642, -1279661, 1917081, -2546312, -1374803, 1500165, 777191, 2235880, 3406031, -542412,
    -2831860, -1671176, -1846953, -2584293, -3724270, 594136, -3776993, -2013608, 2432395, 2454455,
    -164721, 1957272, 3369112, 185531, -1207385, -3183426, 162844, 1616392, 3014001, 810149,
    1652634, -3694233, -1799107, -3038916, 3523897, 3866901, 269760, 2213111, -975884, 1717735,
    472078, -426683, 1723600, -1803090, 1910376, -1667432, -1104333, -260646, -3833893, -2939036,
    -2235985, -420899, -2286327, 183443, -976891, 1612842, -3545687, -554416, 3919660, -48306,
    -1362209, 3937738, 1400424, -846154, 1976782,
];

pub const fn get_eta_poly_eta_bytes(eta: usize) -> usize {
    if eta == 2 {
        96
    } else {
        128
    }
}

pub const fn get_poly_w1_packed_bytes(gamma: usize) -> usize {
    if gamma == ((Q - 1) / 88) as usize {
        192
    } else {
        128
    }
}

#[cfg(test)]
pub const H_TEST: PolyVec<4> = PolyVec::<4> {
    data: [
        Polynomial {
            coefficients: [
                0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
                0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
                0, 0, 0, 0,
            ],
        },
        Polynomial {
            coefficients: [
                0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0,
            ],
        },
        Polynomial {
            coefficients: [
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
                0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0,
                0, 0, 0, 0,
            ],
        },
        Polynomial {
            coefficients: [
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0,
                1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 1,
            ],
        },
    ],
};

#[cfg(test)]
pub const W_ONE_TEST: PolyVec<4> = PolyVec::<4> {
    data: [
        Polynomial {
            coefficients: [
                23, 32, 37, 5, 41, 11, 28, 42, 29, 21, 23, 19, 40, 22, 32, 41, 4, 40, 21, 37, 2,
                40, 41, 30, 40, 28, 18, 8, 19, 13, 9, 16, 41, 17, 9, 31, 28, 2, 11, 43, 29, 27, 31,
                20, 12, 1, 40, 6, 42, 9, 19, 41, 37, 41, 25, 24, 10, 33, 38, 4, 36, 32, 7, 40, 23,
                27, 38, 8, 5, 19, 38, 35, 36, 15, 33, 27, 14, 25, 8, 11, 10, 7, 21, 8, 27, 4, 6, 5,
                15, 39, 6, 27, 5, 25, 37, 25, 26, 43, 38, 18, 43, 31, 33, 9, 7, 18, 34, 34, 18, 24,
                30, 23, 30, 36, 24, 36, 8, 1, 37, 7, 12, 33, 12, 29, 11, 14, 31, 35, 41, 7, 23, 34,
                17, 22, 16, 1, 8, 31, 0, 8, 8, 14, 35, 10, 1, 23, 19, 29, 26, 2, 41, 32, 0, 17, 11,
                9, 4, 20, 2, 38, 15, 8, 14, 22, 34, 4, 34, 15, 39, 13, 42, 0, 16, 18, 1, 13, 2, 37,
                21, 40, 33, 40, 25, 28, 5, 10, 35, 15, 41, 40, 18, 19, 14, 2, 26, 27, 30, 21, 1,
                36, 3, 28, 16, 15, 40, 0, 9, 18, 39, 9, 19, 1, 31, 35, 32, 18, 32, 25, 2, 0, 41,
                34, 41, 3, 31, 12, 0, 16, 24, 5, 17, 34, 29, 5, 27, 38, 43, 40, 1, 35, 22, 7, 21,
                20, 0, 26, 18, 0, 32, 41, 24, 43, 30, 3, 11, 4,
            ],
        },
        Polynomial {
            coefficients: [
                2, 38, 28, 16, 1, 30, 9, 11, 41, 37, 35, 24, 28, 10, 16, 21, 4, 39, 8, 39, 2, 33,
                12, 23, 34, 23, 14, 1, 23, 24, 24, 19, 29, 29, 42, 2, 15, 0, 30, 6, 7, 31, 0, 42,
                39, 25, 41, 39, 25, 29, 4, 0, 33, 14, 32, 34, 21, 23, 11, 19, 25, 37, 30, 28, 24,
                15, 31, 39, 24, 19, 24, 41, 25, 9, 43, 37, 7, 16, 3, 1, 32, 7, 17, 10, 5, 31, 23,
                14, 42, 20, 19, 35, 26, 5, 36, 6, 3, 36, 32, 4, 29, 30, 30, 36, 8, 4, 8, 1, 39, 5,
                0, 22, 20, 7, 17, 31, 42, 14, 24, 30, 31, 0, 31, 27, 35, 5, 12, 42, 12, 18, 20, 20,
                31, 26, 16, 35, 4, 4, 29, 10, 31, 24, 40, 20, 18, 5, 21, 22, 31, 30, 1, 21, 38, 10,
                19, 6, 19, 3, 17, 36, 26, 8, 4, 31, 34, 33, 15, 3, 31, 38, 23, 28, 24, 4, 40, 37,
                12, 9, 12, 40, 40, 11, 4, 17, 2, 12, 38, 14, 28, 40, 35, 22, 39, 1, 16, 1, 1, 34,
                43, 39, 39, 6, 36, 25, 39, 37, 40, 37, 33, 30, 29, 0, 38, 17, 13, 6, 15, 1, 18, 9,
                11, 6, 27, 13, 21, 29, 12, 35, 36, 1, 7, 27, 14, 12, 14, 31, 39, 4, 27, 14, 22, 34,
                21, 22, 41, 27, 39, 28, 5, 15, 27, 10, 11, 34, 8, 29,
            ],
        },
        Polynomial {
            coefficients: [
                40, 27, 23, 36, 19, 10, 34, 27, 34, 36, 9, 40, 13, 7, 2, 40, 39, 22, 40, 10, 5, 11,
                1, 40, 28, 5, 32, 36, 10, 30, 13, 27, 14, 9, 24, 42, 25, 8, 15, 5, 42, 14, 42, 17,
                31, 24, 13, 3, 21, 36, 16, 3, 40, 4, 25, 32, 4, 30, 15, 14, 37, 21, 30, 12, 4, 40,
                8, 1, 37, 5, 14, 33, 15, 39, 40, 38, 6, 1, 40, 0, 41, 7, 6, 36, 13, 31, 5, 32, 33,
                33, 41, 20, 22, 31, 41, 7, 32, 6, 16, 32, 32, 27, 25, 0, 16, 35, 10, 18, 11, 14,
                24, 32, 23, 32, 24, 41, 0, 7, 25, 5, 36, 25, 37, 41, 13, 9, 15, 22, 43, 36, 15, 32,
                19, 10, 14, 16, 34, 27, 2, 38, 13, 42, 2, 3, 12, 2, 38, 41, 20, 20, 43, 31, 36, 18,
                15, 0, 28, 24, 3, 38, 29, 19, 16, 27, 8, 23, 9, 13, 2, 43, 9, 12, 42, 38, 23, 41,
                37, 2, 7, 17, 40, 21, 27, 40, 10, 17, 18, 24, 23, 18, 5, 2, 17, 33, 26, 2, 19, 19,
                37, 11, 7, 0, 10, 15, 6, 43, 30, 13, 12, 26, 42, 41, 3, 17, 34, 20, 11, 15, 25, 27,
                12, 2, 36, 20, 14, 10, 12, 42, 29, 20, 16, 12, 24, 39, 32, 15, 16, 28, 40, 32, 6,
                4, 40, 20, 27, 9, 23, 12, 5, 16, 7, 41, 38, 25, 0, 26,
            ],
        },
        Polynomial {
            coefficients: [
                10, 1, 35, 28, 0, 10, 33, 11, 10, 20, 30, 21, 1, 22, 9, 18, 16, 27, 28, 35, 27, 26,
                29, 12, 1, 1, 0, 8, 12, 21, 1, 21, 8, 42, 21, 19, 36, 31, 33, 29, 9, 38, 21, 36,
                14, 7, 34, 40, 22, 33, 13, 35, 39, 42, 30, 10, 34, 37, 31, 41, 24, 24, 5, 4, 2, 37,
                42, 43, 2, 37, 35, 3, 29, 7, 34, 40, 25, 9, 0, 17, 14, 33, 28, 4, 12, 6, 8, 28, 36,
                18, 24, 24, 20, 20, 39, 32, 18, 35, 4, 28, 21, 37, 8, 3, 14, 26, 26, 9, 26, 30, 13,
                23, 43, 43, 35, 4, 2, 10, 12, 21, 0, 32, 39, 36, 28, 34, 11, 3, 4, 39, 13, 41, 5,
                39, 34, 30, 22, 2, 3, 16, 29, 39, 40, 27, 8, 5, 42, 7, 34, 16, 42, 38, 17, 22, 39,
                34, 34, 17, 7, 35, 5, 27, 20, 39, 32, 38, 7, 23, 24, 27, 16, 41, 22, 4, 22, 14, 38,
                10, 27, 31, 23, 20, 37, 6, 31, 2, 35, 14, 33, 33, 17, 12, 38, 18, 15, 36, 22, 3, 7,
                8, 16, 23, 10, 20, 43, 43, 11, 21, 42, 39, 7, 37, 30, 38, 23, 2, 2, 27, 8, 7, 20,
                8, 13, 4, 39, 24, 42, 27, 43, 26, 31, 34, 14, 37, 41, 30, 36, 23, 43, 0, 23, 20,
                28, 15, 36, 6, 24, 2, 39, 6, 28, 15, 36, 12, 23, 35,
            ],
        },
    ],
};

#[cfg(test)]
pub const SIGNATURE_H_PART: [u8; 84] = [
    3, 31, 38, 39, 58, 59, 78, 79, 82, 130, 133, 148, 154, 179, 187, 201, 202, 205, 213, 222, 226,
    249, 6, 30, 52, 75, 80, 132, 137, 138, 154, 158, 171, 195, 225, 238, 239, 30, 57, 66, 102, 140,
    169, 173, 193, 202, 208, 210, 216, 227, 228, 229, 242, 247, 250, 24, 44, 75, 81, 84, 99, 112,
    129, 141, 176, 178, 196, 198, 201, 204, 213, 217, 220, 230, 232, 255, 0, 0, 0, 0, 22, 37, 55,
    76,
];

#[cfg(test)]
pub const SIGNING_KEY_TEST: [u8; 2528] = [
    245, 151, 124, 130, 131, 84, 106, 99, 114, 59, 195, 29, 38, 25, 18, 79, 17, 219, 70, 88, 100,
    51, 54, 116, 29, 248, 23, 87, 213, 173, 48, 98, 56, 197, 196, 177, 118, 12, 78, 168, 169, 228,
    123, 235, 23, 79, 18, 210, 81, 181, 106, 222, 43, 208, 146, 78, 29, 174, 165, 240, 167, 157,
    29, 141, 117, 34, 22, 38, 25, 243, 50, 155, 83, 18, 50, 45, 62, 228, 91, 135, 22, 222, 144,
    151, 173, 167, 144, 161, 27, 62, 179, 225, 67, 215, 112, 162, 4, 54, 41, 0, 201, 128, 97, 168,
    68, 88, 176, 133, 74, 64, 6, 26, 32, 4, 210, 40, 140, 10, 144, 5, 24, 20, 78, 20, 34, 69, 64,
    168, 104, 76, 64, 68, 68, 18, 66, 34, 55, 16, 226, 192, 100, 4, 129, 144, 164, 200, 8, 9, 3,
    48, 18, 34, 77, 0, 148, 129, 208, 0, 42, 12, 5, 104, 26, 54, 13, 64, 150, 12, 224, 8, 101, 76,
    130, 96, 162, 52, 38, 24, 18, 70, 0, 160, 5, 19, 130, 73, 28, 41, 45, 227, 168, 144, 20, 167,
    96, 12, 147, 112, 130, 8, 134, 1, 38, 146, 203, 176, 33, 24, 194, 8, 96, 68, 144, 72, 128, 100,
    33, 51, 16, 145, 40, 66, 28, 165, 12, 20, 57, 48, 11, 66, 2, 130, 128, 40, 64, 4, 146, 164, 16,
    138, 210, 0, 137, 89, 20, 34, 28, 25, 105, 74, 50, 68, 1, 69, 146, 36, 18, 81, 18, 200, 1, 4,
    16, 81, 228, 194, 69, 20, 23, 37, 204, 184, 64, 100, 22, 17, 11, 8, 138, 16, 181, 137, 136,
    164, 112, 225, 38, 138, 34, 53, 4, 145, 64, 32, 24, 179, 48, 76, 152, 17, 195, 32, 33, 147, 36,
    6, 68, 56, 0, 99, 0, 104, 91, 2, 74, 204, 8, 140, 26, 200, 13, 96, 182, 132, 193, 176, 80, 196,
    192, 45, 210, 198, 104, 216, 2, 106, 10, 36, 37, 192, 178, 137, 34, 66, 17, 28, 160, 77, 128,
    68, 18, 36, 20, 46, 204, 194, 100, 81, 38, 13, 154, 34, 18, 152, 136, 132, 89, 70, 133, 18, 17,
    98, 33, 3, 37, 139, 0, 141, 90, 56, 41, 225, 36, 130, 10, 148, 128, 83, 144, 0, 20, 182, 45,
    33, 177, 40, 16, 152, 132, 140, 8, 5, 201, 70, 113, 163, 52, 4, 33, 153, 69, 4, 48, 130, 211,
    8, 132, 18, 166, 81, 16, 167, 105, 18, 183, 101, 4, 3, 112, 226, 194, 81, 27, 180, 13, 147,
    136, 144, 20, 183, 80, 28, 153, 133, 9, 49, 5, 140, 56, 50, 26, 163, 32, 3, 6, 133, 25, 163,
    81, 202, 54, 140, 25, 48, 96, 138, 2, 128, 0, 196, 65, 156, 152, 69, 25, 21, 77, 204, 38, 104,
    8, 160, 4, 11, 1, 16, 74, 176, 108, 16, 150, 48, 24, 38, 144, 28, 7, 145, 36, 25, 34, 132, 40,
    136, 128, 200, 140, 131, 50, 37, 216, 144, 105, 66, 180, 97, 68, 8, 140, 220, 66, 69, 152, 52,
    101, 27, 20, 42, 137, 144, 48, 36, 68, 77, 147, 0, 40, 19, 65, 49, 210, 52, 34, 136, 72, 69,
    88, 194, 104, 0, 152, 144, 18, 36, 98, 10, 136, 8, 12, 179, 41, 20, 168, 137, 88, 180, 113, 18,
    48, 105, 75, 152, 97, 72, 128, 72, 130, 2, 40, 32, 169, 64, 192, 66, 105, 138, 6, 81, 73, 194,
    132, 90, 24, 98, 67, 2, 70, 82, 18, 0, 156, 64, 66, 27, 66, 32, 35, 179, 80, 72, 64, 109, 164,
    178, 112, 216, 52, 10, 73, 178, 97, 217, 150, 129, 98, 72, 102, 202, 8, 109, 196, 24, 2, 18,
    153, 5, 34, 17, 142, 145, 152, 128, 204, 196, 76, 73, 178, 145, 3, 6, 48, 100, 34, 4, 32, 72,
    140, 88, 0, 48, 27, 33, 6, 154, 132, 5, 4, 49, 136, 152, 68, 45, 33, 37, 112, 4, 176, 4, 32,
    40, 6, 137, 152, 49, 67, 160, 1, 99, 48, 77, 217, 8, 141, 4, 18, 141, 24, 67, 44, 12, 64, 133,
    84, 4, 5, 17, 3, 70, 195, 132, 128, 16, 48, 34, 224, 178, 144, 27, 22, 74, 74, 182, 105, 90,
    34, 137, 98, 18, 4, 36, 57, 38, 36, 199, 41, 24, 146, 108, 227, 22, 146, 196, 134, 112, 1, 40,
    138, 90, 8, 130, 153, 48, 72, 3, 53, 109, 161, 68, 144, 210, 34, 4, 144, 130, 101, 144, 134,
    145, 17, 185, 1, 19, 185, 128, 227, 136, 97, 156, 166, 81, 1, 53, 74, 0, 193, 1, 129, 56, 5,
    17, 33, 137, 64, 200, 108, 218, 72, 41, 8, 51, 73, 11, 182, 133, 161, 144, 48, 129, 66, 45,
    148, 164, 5, 210, 196, 65, 65, 72, 41, 4, 179, 69, 161, 54, 112, 99, 36, 40, 20, 199, 128, 147,
    152, 145, 72, 70, 72, 192, 54, 108, 224, 128, 96, 138, 128, 1, 81, 182, 133, 153, 200, 64, 18,
    168, 101, 82, 198, 76, 138, 16, 64, 224, 144, 16, 246, 244, 86, 109, 35, 71, 226, 135, 131,
    140, 75, 207, 56, 56, 92, 66, 119, 128, 105, 142, 11, 254, 171, 32, 213, 225, 172, 220, 226,
    70, 232, 26, 105, 76, 245, 178, 69, 254, 186, 31, 139, 176, 69, 159, 198, 110, 186, 43, 139,
    66, 13, 218, 109, 83, 192, 84, 91, 51, 123, 240, 250, 49, 230, 230, 22, 49, 114, 134, 23, 153,
    162, 127, 150, 151, 30, 119, 230, 176, 217, 110, 184, 100, 52, 196, 185, 188, 74, 134, 56, 108,
    53, 193, 169, 28, 69, 87, 23, 205, 12, 40, 10, 82, 186, 47, 54, 63, 102, 31, 168, 9, 227, 152,
    24, 24, 205, 98, 188, 205, 119, 59, 108, 240, 251, 11, 23, 196, 243, 37, 143, 149, 53, 127,
    179, 50, 245, 144, 150, 143, 19, 94, 174, 37, 13, 186, 255, 232, 157, 195, 103, 80, 91, 55, 83,
    75, 120, 119, 70, 189, 60, 161, 175, 155, 115, 243, 163, 173, 215, 39, 206, 2, 211, 240, 112,
    105, 98, 68, 119, 113, 198, 107, 152, 158, 211, 149, 84, 151, 221, 144, 176, 80, 155, 130, 182,
    120, 239, 170, 144, 145, 252, 193, 200, 87, 29, 8, 7, 88, 110, 70, 233, 216, 69, 179, 140, 107,
    245, 117, 201, 3, 116, 201, 3, 203, 108, 249, 149, 255, 57, 34, 91, 104, 139, 27, 139, 238, 54,
    254, 48, 36, 242, 136, 118, 211, 15, 248, 123, 64, 239, 133, 93, 150, 27, 53, 83, 140, 18, 101,
    6, 243, 33, 206, 204, 234, 41, 3, 77, 23, 47, 63, 192, 2, 249, 243, 36, 241, 225, 245, 37, 179,
    95, 12, 150, 61, 209, 166, 33, 161, 65, 103, 163, 74, 254, 158, 204, 76, 62, 150, 229, 249, 8,
    151, 183, 197, 45, 9, 193, 149, 113, 41, 12, 198, 26, 25, 67, 194, 53, 101, 19, 76, 115, 178,
    58, 71, 241, 96, 36, 222, 217, 103, 167, 112, 80, 200, 39, 33, 104, 50, 96, 80, 33, 214, 162,
    164, 139, 100, 90, 40, 168, 170, 236, 158, 2, 48, 226, 232, 72, 35, 197, 228, 209, 164, 237,
    134, 164, 68, 187, 153, 24, 148, 2, 130, 211, 66, 141, 170, 176, 174, 111, 73, 214, 16, 63,
    197, 84, 210, 95, 135, 206, 219, 189, 84, 242, 38, 120, 32, 213, 126, 172, 253, 75, 169, 76,
    207, 92, 173, 235, 206, 59, 94, 197, 59, 208, 123, 195, 81, 231, 135, 150, 49, 180, 111, 248,
    93, 145, 219, 132, 142, 158, 94, 198, 61, 242, 177, 149, 234, 213, 21, 153, 77, 79, 147, 232,
    65, 32, 232, 247, 10, 225, 167, 63, 38, 149, 122, 130, 31, 235, 207, 49, 184, 180, 234, 223,
    41, 145, 59, 9, 81, 76, 65, 170, 119, 218, 17, 12, 173, 119, 71, 204, 22, 238, 39, 111, 209,
    215, 117, 216, 82, 70, 24, 253, 184, 79, 171, 202, 134, 118, 118, 34, 114, 164, 176, 14, 105,
    23, 29, 71, 75, 102, 35, 156, 43, 165, 17, 201, 74, 183, 5, 2, 236, 53, 0, 162, 255, 73, 96,
    54, 35, 212, 177, 192, 19, 38, 189, 20, 216, 135, 224, 76, 187, 12, 116, 79, 148, 182, 155,
    138, 150, 27, 197, 88, 112, 143, 184, 40, 141, 209, 174, 1, 43, 17, 12, 134, 170, 63, 187, 80,
    42, 90, 136, 58, 92, 23, 138, 237, 149, 247, 231, 126, 30, 32, 210, 173, 249, 34, 202, 136,
    250, 230, 177, 129, 27, 144, 230, 96, 27, 76, 170, 52, 240, 120, 180, 185, 71, 2, 83, 111, 33,
    149, 147, 246, 62, 206, 218, 146, 220, 64, 240, 157, 238, 82, 205, 224, 85, 243, 202, 176, 126,
    232, 146, 67, 229, 250, 185, 196, 116, 159, 143, 75, 10, 203, 17, 163, 116, 80, 44, 159, 141,
    138, 148, 225, 237, 16, 186, 106, 205, 45, 98, 123, 65, 103, 247, 188, 183, 204, 169, 222, 53,
    177, 116, 45, 176, 204, 126, 252, 116, 114, 44, 59, 201, 51, 50, 49, 162, 128, 89, 153, 126,
    122, 137, 16, 251, 227, 153, 206, 104, 111, 179, 107, 127, 65, 86, 246, 149, 179, 30, 171, 109,
    95, 233, 47, 86, 172, 43, 146, 214, 238, 140, 181, 174, 173, 89, 193, 242, 96, 234, 209, 44,
    171, 122, 59, 175, 53, 176, 173, 124, 235, 213, 44, 147, 11, 182, 99, 39, 98, 48, 194, 51, 96,
    81, 10, 146, 210, 20, 64, 152, 228, 110, 140, 134, 239, 38, 131, 174, 212, 111, 4, 157, 235,
    195, 139, 191, 7, 246, 125, 114, 125, 204, 61, 95, 219, 55, 20, 156, 142, 38, 245, 71, 170, 33,
    140, 161, 12, 204, 36, 231, 142, 105, 120, 34, 97, 211, 226, 67, 193, 53, 179, 105, 78, 130,
    31, 134, 195, 118, 136, 101, 167, 227, 100, 82, 119, 99, 35, 59, 46, 175, 92, 200, 101, 76,
    200, 254, 240, 254, 184, 154, 81, 147, 234, 216, 42, 155, 45, 214, 198, 69, 8, 255, 147, 192,
    108, 86, 202, 176, 27, 144, 203, 194, 49, 187, 80, 20, 54, 146, 208, 60, 237, 151, 22, 205, 6,
    89, 175, 117, 250, 87, 78, 224, 100, 92, 247, 176, 50, 6, 49, 175, 61, 8, 205, 30, 231, 64,
    233, 115, 206, 112, 71, 60, 162, 230, 61, 212, 109, 239, 232, 170, 42, 145, 73, 71, 122, 231,
    186, 227, 207, 163, 228, 172, 113, 149, 140, 53, 145, 55, 86, 51, 167, 129, 7, 106, 244, 57,
    136, 212, 50, 243, 166, 101, 181, 107, 27, 107, 166, 161, 4, 102, 77, 66, 2, 9, 52, 194, 209,
    46, 204, 44, 131, 226, 6, 102, 233, 193, 61, 100, 99, 181, 167, 229, 225, 217, 115, 101, 155,
    115, 235, 120, 236, 221, 181, 234, 111, 64, 85, 145, 55, 251, 157, 69, 211, 108, 91, 96, 213,
    185, 160, 38, 68, 107, 151, 13, 104, 34, 228, 10, 120, 250, 32, 229, 138, 105, 231, 231, 80,
    236, 191, 185, 53, 2, 171, 141, 107, 178, 154, 28, 143, 183, 140, 52, 82, 81, 11, 205, 136, 73,
    252, 77, 200, 92, 164, 166, 217, 60, 6, 189, 96, 231, 143, 56, 204, 46, 9, 83, 181, 31, 133,
    179, 9, 98, 62, 230, 242, 151, 122, 90, 75, 100, 53, 181, 223, 124, 25, 50, 157, 47, 120, 198,
    103, 108, 112, 48, 224, 59, 160, 253, 201, 119, 198, 91, 176, 20, 199, 202, 8, 131, 112, 71,
    68, 29, 126, 241, 186, 214, 22, 28, 112, 117, 41, 94, 221, 239, 25, 115, 117, 249, 246, 88,
    203, 225, 220, 255, 97, 229, 132, 217, 139, 152, 39, 84, 162, 100, 153, 57, 79, 250, 24, 87,
    39, 226, 58, 167, 180, 253, 189, 123, 102, 165, 58, 170, 19, 221, 30, 242, 89, 17, 138, 235,
    190, 248, 95, 227, 172, 220, 103, 228, 220, 120, 118, 238, 62, 71, 210, 252, 228, 0, 198, 127,
    168, 112, 168, 167, 167, 99, 190, 127, 165, 247, 178, 139, 239, 224, 74, 198, 62, 242, 184,
    214, 138, 11, 229, 160, 90, 153, 86, 76, 164, 243, 116, 188, 202, 170, 12, 57, 154, 240, 58,
    235, 128, 218, 136, 35, 27, 142, 83, 7, 255, 177, 96, 152, 91, 184, 19, 136, 10, 131, 50, 195,
    137, 127, 69, 252, 90, 49, 244, 191, 236, 151, 213, 111, 201, 50, 32, 121, 156, 125, 52, 191,
    54, 139, 8, 144, 117, 19, 255, 82, 48, 42, 6, 62, 62, 202, 78, 133, 56, 217, 135, 195, 189, 5,
    114, 205, 35, 85, 74, 173, 222, 170, 27, 239, 6, 98, 120, 128, 195, 129, 23, 45, 214, 18, 199,
    3, 125, 207, 174, 168, 133, 111, 163, 103, 247, 98, 206, 84, 25, 169, 150, 162, 129, 62, 107,
    156, 119, 143, 81, 222, 226, 252, 234, 174, 106, 53, 64, 137, 236, 247, 110, 164, 89, 227, 8,
    97, 126, 84, 202, 153, 64, 95, 178, 211, 57, 166, 177, 238, 127, 239, 163, 36, 167, 216, 144,
    124, 117, 219, 205, 9, 218, 74, 113, 225, 195, 54, 156, 74, 93, 229, 173, 169, 255, 73, 94,
    169, 209, 213, 107, 242, 1, 66, 182, 73, 184, 221, 218, 157, 6, 45, 228, 107, 54, 152, 64, 238,
    64, 121, 14, 12, 164, 5, 227, 124, 232, 252, 36, 59, 120, 69, 63, 159, 128, 239, 95, 38, 67,
    155, 213, 229, 176, 84, 97, 134, 202, 57, 64, 215, 139, 55, 87, 100, 248, 158, 57, 209, 117,
    17, 206, 242, 183, 26, 242, 190, 144, 231, 112, 17, 132, 242, 15, 59, 150, 232, 30, 76, 95, 76,
    188, 101, 187, 219, 203, 207, 104, 204, 82, 120, 53, 164, 211, 230, 253, 214, 61, 230, 214, 14,
    177, 248, 107, 124, 130, 16, 255, 182, 181, 76, 203, 160, 29, 218, 78, 146, 190, 138, 43, 115,
    57, 182, 76, 177, 204, 84, 246, 232, 83, 218, 235, 35, 189, 252, 177, 164, 26, 83, 242, 12,
    122, 216, 6, 198, 25, 24, 18, 50, 83, 217, 99, 103, 95, 246, 144, 109, 179, 102, 171, 139, 186,
    171, 209, 247, 129, 192, 233, 77, 179, 78, 23, 110, 36, 70, 11, 73, 33, 57, 238, 246, 254, 3,
    113, 12, 38, 129, 165, 132, 58, 180, 84, 94, 81, 6, 255, 138, 158, 179, 164, 69, 41, 149, 220,
    144, 107, 254, 165, 42, 233, 231, 73, 15, 5, 109, 105, 87, 60, 81, 187, 81, 203, 240, 121, 32,
    140, 146, 181, 179, 40, 84, 95, 121, 213, 151, 51, 249, 116, 85, 142, 66, 25, 24, 199, 8, 133,
    21, 142, 187, 144, 230, 41, 253, 120, 45, 143, 149, 46, 13, 7, 10, 124, 20, 88, 244, 161, 39,
    49, 45, 219, 87, 163, 77, 102, 12, 139, 217, 130, 67, 106, 71, 196, 57, 119, 199,
];
